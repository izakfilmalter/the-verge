var AH=function(a){this._dfp=a&&a.dfp;if(!this._dfp){this._dfp=googletag}this._customVariables={};this._adSlots={};this._adUnitsToShow=null;this._pageScope=null;this._adUnitScopes=null;this._debugging=false;this._fetchDisabled=false;this._skippedAdSlots=[];this.log_to_console=function(b){if(typeof SBN!=="undefined"&&SBN.Campaigns){SBN.Campaigns.log(b)}};this.disableFetch=function(){this._fetchDisabled=true};this.addVariable=function(c,b){this._customVariables[c]=b;this._dfp.pubads().setTargeting(c,b)};this.removeVariable=function(b){delete this._customVariables[b];this._dfp.setTargeting(b,null)};this.customVariables=function(){return this._customVariables};this.setAdUnitScopes=function(b){this._adUnitScopes=b};this.setPageScope=function(c){this._pageScope=c;for(var b in c){this.addVariable(b,c[b])}};this.getPageScope=function(b){if(this._pageScope===null){return null}else{return this._pageScope[b]}};this.setAdUnitsOnPage=function(b){this._adUnitsOnPage=b};this.addAdUnitToPage=function(c){var b=this._adUnitsOnPage.concat(c);var f=[];for(var e=0;e<b.length;e++){var d=b[e];if(f.indexOf(d)===-1){f.push(d)}}this._adUnitsOnPage=f};this.isAdUnitInScope=function(f){if(!this.isUsingScope()){return true}var c=this._adUnitScopes[f];if(!c){return true}for(var d in this._pageScope){if(this._pageScope.hasOwnProperty(d)){var e=this._pageScope[d];var b=c[d];if(b){if(!this.arrayInclude(b,e)){this._skippedAdSlots.push(f);var g="Ad unit "+f+' skipped for scope "'+e+'". Available values are: '+b.join(", ")+".";this.log_to_console(g);jQuery("#ads_info_ad_units_skipped").append(" "+f);return false}}}}return true};this.isUsingScope=function(){return(this._pageScope!==null&&this._adUnitScopes!==null)};this.getActiveAdUnits=function(){var d=[];if(typeof this._adUnitsOnPage==="undefined"){return}for(var c=0;c<this._adUnitsOnPage.length;++c){var b=this._adUnitsOnPage[c];if(this.isAdUnitInScope(b)){d.push(b)}}return d};this.showAd=function(b){if(this._adUnitsToShow&&this.arrayInclude(this._adUnitsToShow,b)){this._dfp.display("div-gpt-ad-"+b)}};this.recordSlot=function(c,b,d,e){this._adSlots[b]={};this._adSlots[b]["slug"]=c;this._adSlots[b]["sizes"]=d;if(e&&e.targeting){this._adSlots[b]["targeting"]=e.targeting}};this.defineSlots=function(f){for(var d=0;d<f.length;++d){var e=f[d];var h=this._adSlots[e];var c=h.targeting;var g=googletag.defineSlot(h.slug,h.sizes,"div-gpt-ad-"+e).set("slot_name",e);g.addService(googletag.pubads());g.setTargeting("position",e);if(c){for(var b=0;b<c.length;++b){g.setTargeting(c[b][0],c[b][1])}}}};this.fetchAds=function(){var c=this.getActiveAdUnits();var b=c.slice(0);if(this._debugging&&(typeof this.log_to_console!=="undefined")){this.log_to_console("==========");this.log_to_console("ADS INFO");this.log_to_console("Custom variables:",this._customVariables);this.log_to_console("Page scope:",this._pageScope);this.log_to_console("Ad unit scopes:",this._adUnitScopes);this.log_to_console("All ad units on page:",this._adUnitsOnPage);this.log_to_console("Ad units in scope:",this.getActiveAdUnits());this.log_to_console("-----");this.log_to_console("Fetching ad units:",b);this.log_to_console("==========")}if(!this._fetchDisabled){this.defineSlots(c);this._dfp.pubads().enableSyncRendering();this._dfp.pubads().enableSingleRequest();this._dfp.pubads().addEventListener("slotRenderEnded",function(e){if(Chorus.EventDispatcher&&e.slot&&e.slot.get("slot_name")!==null){var f={lineItem:e.lineItemId,size:e.size,domId:e.slot.b.d,isEmpty:e.isEmpty};var d="dfp:adRendered:"+e.slot.get("slot_name");Chorus.EventDispatcher.publish(d,f,true)}});if(typeof(Krux)!=="undefined"){this._dfp.pubads().setTargeting("ksg",Krux.segments);this._dfp.pubads().setTargeting("kuid",Krux.user)}this._dfp.enableServices();this._adUnitsToShow=c;this._removeUnfetchedAdSlots()}};this._removeUnfetchedAdSlots=function(){var b=this._skippedAdSlots;jQuery(function(){for(var e=0;e<b.length;e++){var c=b[e];var f=jQuery("#div-gpt-ad-"+c);var d=f.parent(".m-ad");f.remove();if(d.children().size()===0){d.remove()}}})};this.arraySubtract=function(g,e){var b=[];for(var d=0;d<g.length;++d){var f=false;for(var c=0;c<e.length;++c){if(g[d]===e[c]){f=true;break}}if(!f){b.push(g[d])}}return b};this.arrayIntersection=function(f,e){var b=[];for(var d=0;d<f.length;++d){for(var c=0;c<e.length;++c){if(f[d]===e[c]&&(!this.arrayInclude(b,f[d]))){b.push(f[d]);break}}}return b};this.arrayIndexOf=function(b,e){for(var d=0,c=b.length;d<c;d++){if(b[d]===e){return d}}return -1};this.arrayInclude=function(b,c){return this.arrayIndexOf(b,c)!==-1}};window.Modernizr=function(ap,ao,an){function I(b){ag.cssText=b}function aa(d,c){return I(ad.join(d+";")+(c||""))}function Y(d,c){return typeof d===c}function W(d,c){return !!~(""+d).indexOf(c)}function U(f,c){for(var h in f){var g=f[h];if(!W(g,"-")&&ag[g]!==an){return c=="pfx"?g:!0}}return !1}function S(g,c,j){for(var i in g){var h=c[g[i]];if(h!==an){return j===!1?g[i]:Y(h,"function")?h.bind(j||c):h}}return !1}function Q(g,f,j){var i=g.charAt(0).toUpperCase()+g.slice(1),h=(g+" "+ab.join(i+" ")+i).split(" ");return Y(f,"string")||Y(f,"undefined")?U(h,f):(h=(g+" "+Z.join(i+" ")+i).split(" "),S(h,f,j))}function O(){al.input=function(f){for(var b=0,a=f.length;b<a;b++){T[f[b]]=f[b] in af}return T.list&&(T.list=!!ao.createElement("datalist")&&!!ap.HTMLDataListElement),T}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" "))}var am="2.7.1",al={},ak=!0,aj=ao.documentElement,ai="modernizr",ah=ao.createElement(ai),ag=ah.style,af=ao.createElement("input"),ae={}.toString,ad=" -webkit- -moz- -o- -ms- ".split(" "),ac="Webkit Moz O ms",ab=ac.split(" "),Z=ac.toLowerCase().split(" "),X={},V={},T={},R=[],P=R.slice,N,M=function(w,v,u,s){var r,q,p,o,h=ao.createElement("div"),g=ao.body,b=g||ao.createElement("body");if(parseInt(u,10)){while(u--){p=ao.createElement("div"),p.id=s?s[u]:ai+(u+1),h.appendChild(p)}}return r=["&#173;",'<style id="s',ai,'">',w,"</style>"].join(""),h.id=ai,(g?h:b).innerHTML+=r,b.appendChild(h),g||(b.style.background="",b.style.overflow="hidden",o=aj.style.overflow,aj.style.overflow="hidden",aj.appendChild(b)),q=v(h,w),g?h.parentNode.removeChild(h):(b.parentNode.removeChild(b),aj.style.overflow=o),!!q},K={}.hasOwnProperty,J;!Y(K,"undefined")&&!Y(K.call,"undefined")?J=function(d,c){return K.call(d,c)}:J=function(d,c){return c in d&&Y(d.constructor.prototype[c],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(a){var h=this;if(typeof h!="function"){throw new TypeError}var g=P.call(arguments,1),f=function(){if(this instanceof f){var b=function(){};b.prototype=h.prototype;var d=new b,c=h.apply(d,g.concat(P.call(arguments)));return Object(c)===c?c:d}return h.apply(a,g.concat(P.call(arguments)))};return f}),X.touch=function(){var a;return"ontouchstart" in ap||ap.DocumentTouch&&ao instanceof DocumentTouch?a=!0:M(["@media (",ad.join("touch-enabled),("),ai,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(b){a=b.offsetTop===9}),a},X.history=function(){return !!ap.history&&!!history.pushState},X.backgroundsize=function(){return Q("backgroundSize")},X.cssanimations=function(){return Q("animationName")},X.csstransforms3d=function(){var b=!!Q("perspective");return b&&"webkitPerspective" in aj.style&&M("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(a,d){b=a.offsetLeft===9&&a.offsetHeight===3}),b},X.csstransitions=function(){return Q("transition")},X.localstorage=function(){try{return localStorage.setItem(ai,ai),localStorage.removeItem(ai),!0}catch(b){return !1}};for(var L in X){J(X,L)&&(N=L.toLowerCase(),al[N]=X[L](),R.push((al[N]?"":"no-")+N))}return al.input||O(),al.addTest=function(e,c){if(typeof e=="object"){for(var f in e){J(e,f)&&al.addTest(f,e[f])}}else{e=e.toLowerCase();if(al[e]!==an){return al}c=typeof c=="function"?c():c,typeof ak!="undefined"&&ak&&(aj.className+=" "+(c?"":"no-")+e),al[e]=c}return al},I(""),ah=af=null,function(av,au){function B(f,e){var h=f.createElement("p"),g=f.getElementsByTagName("head")[0]||f.documentElement;return h.innerHTML="x<style>"+e+"</style>",g.insertBefore(h.lastChild,g.firstChild)}function A(){var b=u.elements;return typeof b=="string"?b.split(" "):b}function z(d){var c=D[d[F]];return c||(c={},E++,d[F]=E,D[E]=c),c}function y(b,h,f){h||(h=au);if(C){return h.createElement(b)}f||(f=z(h));var e;return f.cache[b]?e=f.cache[b].cloneNode():H.test(b)?e=(f.cache[b]=f.createElem(b)).cloneNode():e=f.createElem(b),e.canHaveChildren&&!aq.test(b)&&!e.tagUrn?f.frag.appendChild(e):e}function x(b,l){b||(b=au);if(C){return b.createDocumentFragment()}l=l||z(b);var k=l.frag.cloneNode(),j=0,i=A(),h=i.length;for(;j<h;j++){k.createElement(i[j])}return k}function w(d,c){c.cache||(c.cache={},c.createElem=d.createElement,c.createFrag=d.createDocumentFragment,c.frag=c.createFrag()),d.createElement=function(a){return u.shivMethods?y(a,d,c):c.createElem(a)},d.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+A().join().replace(/[\w\-]+/g,function(b){return c.createElem(b),c.frag.createElement(b),'c("'+b+'")'})+");return n}")(u,c.frag)}function v(b){b||(b=au);var d=z(b);return u.shivCSS&&!G&&!d.hasCSS&&(d.hasCSS=!!B(b,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),C||w(b,d),b}var at="3.7.0",ar=av.html5||{},aq=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,H=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,G,F="_html5shiv",E=0,D={},C;(function(){try{var b=au.createElement("a");b.innerHTML="<xyz></xyz>",G="hidden" in b,C=b.childNodes.length==1||function(){au.createElement("a");var c=au.createDocumentFragment();return typeof c.cloneNode=="undefined"||typeof c.createDocumentFragment=="undefined"||typeof c.createElement=="undefined"}()}catch(d){G=!0,C=!0}})();var u={elements:ar.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:at,shivCSS:ar.shivCSS!==!1,supportsUnknownElements:C,shivMethods:ar.shivMethods!==!1,type:"default",shivDocument:v,createElement:y,createDocumentFragment:x};av.html5=u,v(au)}(this,ao),al._version=am,al._prefixes=ad,al._domPrefixes=Z,al._cssomPrefixes=ab,al.testProp=function(b){return U([b])},al.testAllProps=Q,al.testStyles=M,al.prefixed=function(e,d,f){return d?Q(e,d,f):Q(e,"pfx")},aj.className=aj.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(ak?" js "+R.join(" "):""),al}(this,this.document),function(ad,ac,ab){function aa(b){return"[object Function]"==P.call(b)}function Z(b){return"string"==typeof b}function Y(){}function X(b){return !b||"loaded"==b||"complete"==b||"uninitialized"==b}function W(){var b=O.shift();M=1,b?b.t?R(function(){("c"==b.t?L.injectCss:L.injectJs)(b.s,0,b.a,b.x,b.e,1)},0):(b(),W()):M=0}function V(x,w,v,s,q,p,n){function m(a){if(!g&&X(h.readyState)&&(y.r=g=1,!M&&W(),h.onload=h.onreadystatechange=null,a)){"img"!=x&&R(function(){I.removeChild(h)},50);for(var c in D[w]){D[w].hasOwnProperty(c)&&D[w][c].onload()}}}var n=n||L.errorTimeout,h=ac.createElement(x),g=0,b=0,y={t:v,s:w,e:q,a:p,x:n};1===D[w]&&(b=1,D[w]=[]),"object"==x?h.data=w:(h.src=w,h.type=x),h.width=h.height="0",h.onerror=h.onload=h.onreadystatechange=function(){m.call(this,b)},O.splice(s,0,y),"img"!=x&&(b||2===D[w]?(I.insertBefore(h,J?null:Q),R(m,n)):D[w].push(h))}function U(g,e,j,i,h){return M=0,e=e||"j",Z(g)?V("c"==e?G:H,g,e,this.i++,j,i,h):(O.splice(this.i++,0,g),1==O.length&&W()),this}function T(){var b=L;return b.loader={load:U,i:0},b}var S=ac.documentElement,R=ad.setTimeout,Q=ac.getElementsByTagName("script")[0],P={}.toString,O=[],M=0,K="MozAppearance" in S.style,J=K&&!!ac.createRange().compareNode,I=J?S:Q.parentNode,S=ad.opera&&"[object Opera]"==P.call(ad.opera),S=!!ac.attachEvent&&!S,H=K?"object":S?"script":"img",G=S?"script":H,F=Array.isArray||function(b){return"[object Array]"==P.call(b)},E=[],D={},C={timeout:function(d,c){return c.length&&(d.timeout=c[0]),d}},N,L;L=function(e){function c(i){var i=i.split("!"),h=E.length,q=i.pop(),p=i.length,q={url:q,origUrl:q,prefixes:i},o,l,j;for(l=0;l<p;l++){j=i[l].split("="),(o=C[j.shift()])&&(q=o(q,j))}for(l=0;l<h;l++){q=E[l](q)}return q}function n(b,s,r,q,p){var o=c(b),l=o.autoCallback;o.url.split(".").pop().split("?").shift(),o.bypass||(s&&(s=aa(s)?s:s[b]||s[q]||s[b.split("/").pop().split("?")[0]]),o.instead?o.instead(b,s,r,q,p):(D[o.url]?o.noexec=!0:D[o.url]=1,r.load(o.url,o.forceCSS||!o.forceJS&&"css"==o.url.split(".").pop().split("?").shift()?"c":ab,o.noexec,o.attrs,o.timeout),(aa(s)||aa(l))&&r.load(function(){T(),s&&s(o.origUrl,p,q),l&&l(o.origUrl,p,q),D[o.url]=2})))}function m(x,w){function v(b,h){if(b){if(Z(b)){h||(r=function(){var i=[].slice.call(arguments);q.apply(this,i),p()}),n(b,r,w,0,u)}else{if(Object(b)===b){for(g in o=function(){var a=0,i;for(i in b){b.hasOwnProperty(i)&&a++}return a}(),b){b.hasOwnProperty(g)&&(!h&&!--o&&(aa(r)?r=function(){var i=[].slice.call(arguments);q.apply(this,i),p()}:r[g]=function(i){return function(){var a=[].slice.call(arguments);i&&i.apply(this,a),p()}}(q[g])),n(b[g],r,w,g,u))}}}}else{!h&&p()}}var u=!!x.test,s=x.load||x.both,r=x.callback||Y,q=r,p=x.complete||Y,o,g;v(u?x.yep:x.nope,!!s),s&&v(s)}var k,f,d=this.yepnope.loader;if(Z(e)){n(e,0,d,0)}else{if(F(e)){for(k=0;k<e.length;k++){f=e[k],Z(f)?n(f,0,d,0):F(f)?L(f):Object(f)===f&&m(f,d)}}else{Object(e)===e&&m(e,d)}}},L.addPrefix=function(d,c){C[d]=c},L.addFilter=function(b){E.push(b)},L.errorTimeout=10000,null==ac.readyState&&ac.addEventListener&&(ac.readyState="loading",ac.addEventListener("DOMContentLoaded",N=function(){ac.removeEventListener("DOMContentLoaded",N,0),ac.readyState="complete"},0)),ad.yepnope=T(),ad.yepnope.executeStack=W,ad.yepnope.injectJs=function(r,q,p,n,m,h){var g=ac.createElement("script"),f,b,n=n||L.errorTimeout;g.src=r;for(b in p){g.setAttribute(b,p[b])}q=h?W:q||Y,g.onreadystatechange=g.onload=function(){!f&&X(g.readyState)&&(f=1,q(),g.onload=g.onreadystatechange=null)},R(function(){f||(f=1,q(1))},n),m?g.onload():Q.parentNode.insertBefore(g,Q)},ad.yepnope.injectCss=function(b,n,m,l,k,h){var l=ac.createElement("link"),f,n=h?W:n||Y;l.href=b,l.rel="stylesheet",l.type="text/css";for(f in m){l.setAttribute(f,m[f])}k||(Q.parentNode.insertBefore(l,Q),R(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};if(typeof(SBN)=="undefined"){SBN=new Object()}SBN.Facebook={SDK:{init:function(a){window.fbAsyncInit=function(){FB.init({appId:a,status:true,cookie:true,xfbml:true});if(Chorus&&Chorus.EventDispatcher){Chorus.EventDispatcher.publish("facebookSdkAvailable")}}}},Connect:{initModal:function(a,c){c=Object.extend({overlayOpacity:0.5},c||{});var b=new Control.Modal(null,c);b.container.insert('<iframe class="sbn_facebook_iframe" frameborder="0" width="100%" height="100%" allowtransparency="true" src="'+a+'" style="overflow:hidden;display:none"></iframe>');b.open();$("control_overlay").innerHTML='<div class="control_overlay_spinner"></div>'},displayModal:function(){$$(".sbn_facebook_iframe").each(function(a){a.show()});setTimeout(function(){$("control_overlay").innerHTML=""},1000)}}};"use strict";var Chorus=Chorus||{};Chorus.Environment=(function(f){var h=[{index:0,name:"bp-xx-small",min:0,max:399},{index:1,name:"bp-x-small",min:400,max:499},{index:2,name:"bp-x-small-small",min:500,max:599},{index:3,name:"bp-small",min:600,max:699},{index:4,name:"bp-small-medium",min:700,max:799},{index:5,name:"bp-medium",min:800,max:899},{index:6,name:"bp-medium-large",min:900,max:1024},{index:7,name:"bp-large",min:1025,max:1199},{index:8,name:"bp-x-large",min:1200,max:1440},{index:9,name:"bp-xx-large",min:1441,max:99999}];var j=null,a=f(window);var i=("ontouchstart" in window)||(window.DocumentTouch&&document instanceof DocumentTouch)||(navigator.msMaxTouchPoints>0)||(navigator.maxTouchPoints>0),d,b=null;var e=function(){var k=k||null,n=h[8];if(k){if(k===0||k===180){d="landscape"}if(k===90||k===-90){d="portrait"}}else{d=null}var m=a.width();for(var l=h.length-1;l>-1;l--){var o=h[l];if(m>=o.min&&m<=o.max){if(b===null||b.index!==o.index){b=JSON.parse(JSON.stringify(o));a.trigger(new f.Event("breakpointchange",{currentBreakpoint:b}))}return}}if(b===null||b.index!==n.index){b=JSON.parse(JSON.stringify(n));a.trigger(new f.Event("breakpointchange",{currentBreakpoint:b}))}};a.bind("resize orientationchange",function(){clearTimeout(j);j=setTimeout(function(){clearTimeout(j);e()},20)});var g=window.matchMedia("(max-width: "+h[3].min+"px)");var c=window.matchMedia("(min-width: "+h[7].min+"px)");return{currentBreakpoint:function(){if(b==null){e()}return b},touch:function(){return i},orientation:function(){return d},setBreakpoints:function(k){if(f.type(k)==="array"){h=k;e()}},largeBreakpoint:c,smallBreakpoint:g}})(jQuery);(function(g){var f={toPositionInteger:function(i,k){var j=parseInt(i,10);return isNaN(j)?k:j},insertBefore:function(i,l,j){var k=g(i).get(j);if(k){g(k).before(l)}},appendStyle:function(j,i){g(j).append("<style>"+i+"</style>")},colorize:function(i,j,k){k=k||"color";g(i).css(k,j)},assignOddEven:function(i){g(i).each(function(j){if(j%2===0){g(this).removeClass("odd");g(this).addClass("even")}else{g(this).addClass("odd");g(this).removeClass("even")}})},createVideoIframeFromEmbedCodeAndPlaceIn:function(i,j){var l=document.createElement("IFRAME");l.style.width="100%";l.style.height="100%";l.style.border="0";var m='<script>var e = document.getElementsByTagName("div");for(var i = 0; i < e.length; i++){e[i].style.width = "auto"; e[i].style.height="auto";}<\/script>';var k="<html><head><style>body{margin:0;} .OoyalaVideoPlayer {width:100%; height:100%;}</style></head>"+i+m+"<body></body></html>";g(j).empty().append(l);l.contentWindow.document.open();l.contentWindow.document.write(k);l.contentWindow.document.close()},waitForLazyContent:function(j,l){var i=false;var k=function(){if(!i&&g(j).length){i=true;l()}};k();Chorus.EventDispatcher.subscribe("moduleInserted",k)},limitCharacterCount:function(i,m){var l=i.indexOf(" ",m);if(l==-1){return i}else{var k=i.substring(0,l);var j=/[A-Za-z0-9]/;if(j.test(k.slice(-1))){k+="..."}return k}},declobberBackground:function(i){var j=g(i);var k=j.css("background-image");j.attr("style","");j.css("background-image",k)},makeSponsorClickable:function(j,i){i=i||".harmony-sponsorship,.harmony-byline";g(j._element).find(i).css("cursor","pointer").click(function(){window.location=j.clickThroughUrl})}};var d={LatestTreatment:function(j){f.colorize(".harmony-latest .harmony-sponsorship",j.fields.brand_color);var i=f.toPositionInteger(j.fields.position,4);f.insertBefore(".m-rock.m-latest-news ul.m-rock__list li",j._element,i)},VideoTreatment:function(i){g(i._element).hide();f.waitForLazyContent(".m-breaker.video",function(){var j=f.toPositionInteger(i.fields.position,3);f.insertBefore(".m-breaker__body a",i._element,j);g(i._element).show();f.colorize(".harmony-video .harmony-sponsorship",i.fields.brand_color);var k=g(".m-breaker.video .m-breaker__body a");if(k.length>4){g(".m-breaker.video .m-breaker__body a").last().remove()}})},MobileTreatment:function(i){f.colorize(".harmony-mobile .harmony-sponsorship",i.fields.brand_color);f.colorize(".harmony-mobile .harmony-title",i.fields.brand_color)},ContentLinkTreatment:function(i){g(".harmony-content-link .harmony-powered-by").append("&nbsp;");var j=i.fields.description;j=f.limitCharacterCount(j,160);g(".harmony-content-link .harmony-description").text(j)}};var a={LatestTreatment:function(j){f.colorize(".harmony-latest .harmony-sponsorship",j.fields.brand_color);var i=f.toPositionInteger(j.fields.position,4);f.insertBefore(".p-rock__basic-article-list li",j._element,i)},VideoTreatment:function(l){var k=g("#video-hero-player");var m=function(){f.createVideoIframeFromEmbedCodeAndPlaceIn(l.fields.video_embed_code,k)};var j=g("<li></li>").addClass("m-video-hero__playlist-entry is-not-playing harmony-video");j.html(g(l._element).html());$thumb=j.find(".harmony-thumbnail");$thumb.addClass("play-icon");j.on("click",function(n){m();n.stopImmediatePropagation();n.stopPropagation();return false});f.colorize(".harmony-video .harmony-preamble",l.fields.brand_color);g(l._element).remove();var i=f.toPositionInteger(l.fields.position,2);f.insertBefore(".m-video-hero__playlist ul li",j,i)},MobileTreatment:function(i){f.colorize(".harmony-mobile .harmony-sponsorship",i.fields.brand_color);f.colorize(".harmony-mobile .harmony-title",i.fields.brand_color)},ContentLinkTreatment:function(l){var j=80;var o=210;var k=g(l._element);var p=k.find(".harmony-thumbnail");f.declobberBackground(p);k.find(".harmony-byline").append(k.find(".harmony-logo"));k.find(".harmony-info").after(p);k.find(".harmony-preamble").addClass("harmony-eyebrow");k.find("a.harmony-title").wrap("<h3></h3>");k.find(".harmony-byline").addClass("m-entry-slot__meta");var i=k.find(".harmony-description");i.addClass("m-entry-slot__blurb");i.text(f.limitCharacterCount(i.text(),o));k.find(".harmony-quote").replaceWith(g("<q>"+f.limitCharacterCount(k.find(".harmony-quote").text(),j)+"</q>"));if(k.parents("div.m-hero__slot").length){p.addClass("p-dynamic-image")}var n=g(".m-entry-slot__mobile-list .proxy-container-harmony_content_link");if(n.length){var m=g(".harmony-info").clone().addClass("m-entry-slot__content");n.append(p.clone());n.find(".harmony-thumbnail").wrap('<div class="m-entry-slot__image"></div>');n.append(m)}}};var c={LatestTreatment:function(j){f.colorize(".harmony-latest .harmony-sponsorship",j.fields.brand_color);j._element.addClass("m-rail-component__list__item");var i=f.toPositionInteger(j.fields.position,5);f.insertBefore(".m-rail-component ul.m-rail-component__list li",j._element,i);f.assignOddEven("ul.m-rail-component__list>*")},VideoTreatment:function(k){g(k._element).hide();var l=g("#video_browser");var i=l.html();var m=function(){f.createVideoIframeFromEmbedCodeAndPlaceIn(k.fields.video_embed_code,l)};var j=f.toPositionInteger(k.fields.position,2);f.insertBefore(".m-video-browser__thumb-container li",k._element,j);g(k._element).show();g(k._element).addClass("m-video-browser__thumb-image");f.colorize(".harmony-video .harmony-preamble",k.fields.brand_color);g(".m-video-browser__thumb-container li").last().remove();g(k._element).find(".harmony-thumbnail").on("click",function(n){m();l.addClass("playing");g(k._element).find(".harmony-thumbnail").addClass("playing");n.stopImmediatePropagation();n.stopPropagation();return false})},ContentLinkTreatment:function(l){var k=g(l._element);var j=k.parents(".placeableadunit");j.find(".dfp_ad, .harmony_content_link, #div-gpt-ad-harmony_content_link_ad_container").css("height","100%");k.find(".harmony-thumbnail").addClass("block_img");f.declobberBackground(k.find(".harmony-thumbnail"));k.find(".harmony-title").wrap('<div class="meta"><h2></h2></div>');k.find(".harmony-byline").addClass("byline").detach().appendTo(k.find(".meta"));var i=".polygon a.harmony-thumbnail.block_img::after{background-color: "+l.fields.brand_color+"!important; background-image: none !important;}";f.appendStyle(k,i);if(l.fields.preamble.length){j.find("header").html("<h6>"+l.fields.preamble+"</h6>");f.colorize(j.find("header"),l.fields.brand_color);f.colorize(j.find("header h6"),l.fields.brand_color,"border-bottom-color")}else{j.find("header").remove()}},MobileTreatment:function(i){f.colorize(".harmony-mobile .harmony-sponsorship",i.fields.brand_color);f.colorize(".harmony-mobile .harmony-title",i.fields.brand_color)}};var e={LatestTreatment:function(i){f.colorize(".harmony-latest .harmony-sponsorship",i.fields.brand_color)},VideoTreatment:function(m){var l=".m-video-link-set__additional .m-video-link-set__item";var n=g(".m-inplace-video-player");var i=n.html();var o=function(){f.createVideoIframeFromEmbedCodeAndPlaceIn(m.fields.video_embed_code,n)};var j=f.toPositionInteger(m.fields.position,2);f.insertBefore(l,m._element,j);var k=g(l+" svg").first().clone();g(m._element).append(k);f.colorize(".harmony-video .harmony-preamble",m.fields.brand_color);g(l).last().remove();g(m._element).find(".harmony-thumbnail").on("click",function(p){o();n.addClass("playing");g(m._element).find(".harmony-thumbnail").addClass("playing");p.stopImmediatePropagation();p.stopPropagation();return false})},MobileTreatment:function(i){f.colorize(".harmony-mobile .harmony-sponsorship",i.fields.brand_color);f.colorize(".harmony-mobile .harmony-title",i.fields.brand_color)},ContentLinkTreatment:function(j){g(".harmony-content-link .harmony-thumbnail").css("background-size","cover");g(".harmony-content-link .harmony-thumbnail").css("background-position","center");g(".harmony-content-link a.harmony-thumbnail").append('<div class="harmony-tint-overlay"/>');g(".harmony-content-link .harmony-tint-overlay").css("background-color",j.fields.brand_color);g(".harmony-content-link .harmony-powered-by").append("&nbsp;");g(".harmony-content-link .harmony-sponsorship").insertBefore(".harmony-content-link .harmony-thumbnail");var i=g(".m-entry-box .harmony-content-link .harmony-info");i.detach();g(".m-entry-box .harmony-content-link .harmony-thumbnail").append(i)}};var b={LatestTreatment:function(i){f.colorize(".harmony-latest .harmony-sponsorship",i.fields.brand_color)},VideoTreatment:function(j){var i=g(j._element);i.hide();f.waitForLazyContent(".m-breaker-block-videos",function(){var k=g(".m-breaker-block-videos .m-breaker-block__articles");k.append(i);var l=i.find(".harmony-sponsorship");f.colorize(l,j.fields.brand_color);l.detach();i.prepend(l);i.show()})},MobileTreatment:function(i){f.colorize(".harmony-mobile .harmony-sponsorship",i.fields.brand_color);f.colorize(".harmony-mobile .harmony-title",i.fields.brand_color)},ContentLinkTreatment:function(l){g(".harmony-content-link a.harmony-thumbnail").append('<div class="harmony-tint-overlay"/>');g(".harmony-content-link .harmony-tint-overlay").css("background-color",l.fields.brand_color);var k=g(".harmony-content-link .harmony-sponsorship");k.detach();g(".harmony-content-link .harmony-thumbnail").append(k);var j=g(".harmony-content-link .harmony-info");j.detach();g(".harmony-content-link .harmony-sponsorship").append(j);var i=g(".harmony-content-link .harmony-preamble");i.detach();g(".harmony-content-link .harmony-sponsorship").append(i);var m=g('<div class="harmony-ad-flag">Advertisement</div>');m.css("background-color",l.fields.brand_color);m.insertBefore(".harmony-content-link")}};var h=function(i){if(i.type==="Harmony"){if(g('head[data-network="sbn"]').length){switch(i.design_template){case"Harmony Latest":d.LatestTreatment(i);break;case"Harmony Video":d.VideoTreatment(i);break;case"Harmony Mobile":d.MobileTreatment(i);break;case"Harmony Content Link":d.ContentLinkTreatment(i);break}}if(g('head[data-network="verge"]').length){switch(i.design_template){case"Harmony Latest":a.LatestTreatment(i);break;case"Harmony Video":a.VideoTreatment(i);break;case"Harmony Mobile":a.MobileTreatment(i);break;case"Harmony Content Link":a.ContentLinkTreatment(i);break}}if(g('head[data-network="eater"]').length){switch(i.design_template){case"Harmony Latest":e.LatestTreatment(i);break;case"Harmony Video":e.VideoTreatment(i);break;case"Harmony Mobile":e.MobileTreatment(i);break;case"Harmony Content Link":e.ContentLinkTreatment(i);break}}if(g('head[data-network="polygon"]').length){switch(i.design_template){case"Harmony Latest":c.LatestTreatment(i);break;case"Harmony Video":c.VideoTreatment(i);break;case"Harmony Mobile":c.MobileTreatment(i);break;case"Harmony Content Link":c.ContentLinkTreatment(i);break}}if(g('head[data-network="vox"]').length){switch(i.design_template){case"Harmony Latest":b.LatestTreatment(i);break;case"Harmony Video":b.VideoTreatment(i);break;case"Harmony Mobile":b.MobileTreatment(i);break;case"Harmony Content Link":b.ContentLinkTreatment(i);break}}f.makeSponsorClickable(i)}};g(document).on("hymnal:render",function(i,j){h(j.ad)})})(jQuery);window.$j=window.$;var Util=Util||{};Util.UserAgentProfiler=(function(){var l=("ontouchstart" in window)||(window.DocumentTouch&&document instanceof DocumentTouch)||(navigator.msMaxTouchPoints>0),b=window.innerWidth,c=window.navigator.userAgent,n=(l&&b<728)||(window.location.href.indexOf("mobile=true")>0),h=l&&b>=728,e=!n&&!h,o=/(iPad|iPhone|iPod)/g.test(c),j=(o&&/OS\s(7|6_1_4)/g.test(c)),k=/Android/g.test(c),p=false,a=(n)?"mobile":(h)?"tablet":"desktop";if(c.indexOf("Android")>0){var f=c.split(";");for(var d=0,g=f.length;d<g;d++){if(f[d].indexOf("Android")>0){var m=f[d].split(" ");if(parseInt(m[m.length-1].split(".")[0])<3){p=true;break}}}}return{screenWidth:function(){return b},profile:function(){return a},isTablet:function(){return h},isMobile:function(){return n},isDesktop:function(){return e},isAndroid:function(){return k},isAndroidLt3:function(){return p},isIOS:function(){return o},isIOS7:function(){return j},deviceTypeForAds:function(){return this.profile()},browserWidthForAds:function(){return Chorus.Environment.currentBreakpoint().name}}})();var SBN=SBN||{};SBN.Campaigns=SBN.Campaigns||{};SBN.Campaigns.log=function(a){if((typeof(console)!=="undefined")&&(typeof(console.log)==="function")&&jQuery("#ads_info_content").length!==0){console.log("[Ads]: "+a)}};SBN.Campaigns.Components={clickUrls:{},activatedComponents:Array(),componentProperties:["campaign_id","component_name","component_id","component_type"],callbacks:{},config:{},renderedComponent:null,componentClickUrls:{},recordClickUrl:function(b,a){this.componentClickUrls[b]=a},click:function(b,c){url=this.componentClickUrls[b];var a;if(typeof(jQuery)==="undefined"){a=Object.extend}else{a=jQuery.extend}c=a({newWindowName:null},c||{});if(url){if(c.newWindowName!==null){window.open(url,c.newWindowName)}else{window.location=url}}},logActivation:function(b,d,a,c){this.activatedComponents.push({component_name:b,component_id:d,campaign_id:a,component_type:c})},activeComponentContext:function(){var d={};for(var c=0;c<this.componentProperties.length;++c){var e=this.componentProperties[c];for(var b=0;b<this.activatedComponents.length;++b){var a=this.activatedComponents[b];var f=a[e];if(f){if(!d[e]){d[e]=[]}d[e].push(f)}}}return d},setCustomVarsFromActiveComponents:function(){var b=this.activeComponentContext();for(var a in b){SBN.Ads.addVariable(a,b[a])}}};SBN.Campaigns.trackingImageProxy=(function(){return{callbacks:[],images:[],loaded:false,registerCallback:function(a){this.callbacks.push(a);this.createImages()},registerImage:function(a){this.images.push(a);this.createImages()},createImages:function(d){if(!d&&!this.loaded){return}var c;while(c=this.images.pop()){var b=document.createElement("img");b.src=c.replace(/%%/g,"");b.height=1;b.width=1;document.body.appendChild(b)}var a;while(a=this.callbacks.pop()){a.call(window)}},load:function(){this.loaded=true;this.createImages(true)}}})();if(typeof(jQuery)!=="undefined"){jQuery(function(){SBN.Campaigns.trackingImageProxy.load()})}SBN.Campaigns.loadMoatForHarmonyContent=function(e,b,h,c){var a=h;var d="http://js.moatads.com/voxmedia4590538913/moatad.js#moatClientLevel1="+e+"&moatClientLevel2="+b+"&moatClientLevel3="+h+"&moatClientLevel4="+h+"&moatClientSlicer1=VoxMedia&moatClientSlicer2="+a;var f=jQuery('*[data-parent-moat-ad-id="'+c+'"]').first().parent();if(f.length){f.attr("data-moat-ad-id",c);var g=document.createElement("SCRIPT");g.type="text/javascript";g.charset="UTF-8";g.src=d;f.after(g)}};SBN.Campaigns.renderComponent=function(a){switch(a.type){case"clientReskin":case"headerReskin":SBN.Campaigns.renderReskin(a);break;default:SBN.Campaigns.log("Component type not recognized: "+a.type)}};SBN.Campaigns.renderReskin=function(reskin){var head=document.getElementsByTagName("head")[0],style=document.createElement("style"),rules=document.createTextNode(reskin.style);style.type="text/css";if(style.styleSheet){style.styleSheet.cssText=rules.nodeValue}else{style.appendChild(rules)}if(reskin&&reskin.component&&reskin.component.componentId){style.id="stylesheet_component_"+reskin.component.componentId;jQuery("body").addClass("body_component_"+reskin.component.componentId);if(reskin.component.secondary_tracker_url){SBN.Campaigns.trackingImageProxy.registerImage(reskin.component.secondary_tracker_url)}SBN.Campaigns.Components.renderedComponent=reskin}head.appendChild(style);eval(reskin.js);if(SBN.Campaigns.Components.renderedComponent){SBN.Campaigns.log("SBN.Campaigns.Components.renderedComponent is now: "+SBN.Campaigns.Components.renderedComponent.component.componentId)}};SBN.Campaigns.renderAdServedReskin=function(a){jQuery(function(){if(jQuery.browser&&jQuery.browser.msie&&jQuery.browser.version<9){return}SBN.Campaigns.renderComponent(a);if(Chorus&&Chorus.EventDispatcher&&Chorus.EventDispatcher.publish&&typeof(a.component.data.useLightLogo)!=="undefined"){Chorus.EventDispatcher.publish("campaignReskinApplied",{useLightLogo:a.component.data.useLightLogo,useThirdLogo:a.component.data.useThirdLogo,useSolidBackground:a.component.data.useSolidBackground,useAlternateSocialIcons:a.component.data.useAlternateSocialIcons},true)}})};SBN.Campaigns.getComponentInfoList=function(){var b=jQuery("#ads_info_content");if(b.length===0){return null}var a=jQuery("#component-ads-info");if(a.length===0){b.append('<p class="toggler"><a onclick="SBN.Ads.toggleSection(this, \'#component-ads-info\')">+</a></p>').append("<h3>Results of Component Geotargeting</h3>").append('<p id="component-ads-geo-info" style="font-style:italic; font-size:11px; margin-top:-20px;">');a=jQuery('<ul id="component-ads-info" style="display:none" />').appendTo(b)}return a};SBN.Campaigns.updateComponentStatusInInfoPane=function(c,a){var b=SBN.Campaigns.getComponentInfoList();if(!b){return}var g,f,d="";if(typeof(c)==="string"){g=c}else{g=c.component.trackerId;if(c.component.data.geotargeted){d="(GEO)&nbsp;"}}f=jQuery("#component-ads-info-"+g);var e={headerReskin:"Header Reskin",clientReskin:"Reskin",topHat:"Top Hat",fishtank:"Fishtank"};if(f.length===0){f=jQuery("<li />").attr("id","component-ads-info-"+c.component.trackerId).html(e[c.type]+" "+c.component.trackerId+"&nbsp;"+d).append('<span class="status" />').appendTo(b)}var h=a?"("+a+")":"";f.find(".status").text(h);if(a==="Rendered"){f.css("font-weight","bold")}};SBN.Campaigns.belowNavAdMarkup=null;SBN.Campaigns.renderBelowNavAdMarkupIfApplicable=function(){if(SBN.Campaigns.belowNavAdMarkup!=="undefined"&&SBN.Campaigns.belowNavAdMarkup){var a=document.getElementById("leaderboard_ad");if(a){a.style.display="none"}if(document.readyState!=="complete"){document.write($("<div/>").html(SBN.Campaigns.belowNavAdMarkup).text())}}};var Util=Util||{};Util.getUrlVars=function(){var d={},c;var a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var b=0;b<a.length;b++){var c=a[b].split("=");val=c[1],retVal=(val=="true")?true:(val=="false")?false:null;if(retVal==null){retVal=(isNaN(parseInt(val))==false)?parseInt(val):(isNaN(parseFloat(val))==false)?parseFloat(val):val}d[c[0]]=retVal}return d};Util.inViewport=function(b){var c,a;if(!b||1!==b.nodeType){return false}a=document.documentElement;c=b.getBoundingClientRect();return(!!c&&c.bottom>0&&c.right>0&&c.top<a.clientHeight&&c.left<a.clientWidth)};Util.detectCSSFeature=function(d){var c=["Webkit","Moz","ms","O"],e=document.createElement("div"),a=null,d=d.toLowerCase();if(e.style[d]){return true}a=d.charAt(0).toUpperCase()+d.substr(1);for(var b=c.length-1;b>-1;b--){if(e.style[c[b]+a]!==undefined){return true}}return false};Util.getReferrerDomain=function(){return document.referrer.split("/")[2]};Util.isReferrerCurrentDomain=function(){return Util.getReferrerDomain()===window.location.host};Util.socialReferrer=function(){var b=Util.getUrlVars().debugReferrer;var a=b||this.getReferrerDomain();if(a){a=a.replace(/^www\./i,"");if(["twitter.com","t.co"].indexOf(a)>-1){return"twitter"}if(["facebook.com","fb.me"].indexOf(a)>-1){return"facebook"}if("plus.google.com"===a){return"google-plus"}if("sports.yahoo.com"===a){return"yahoo sports"}}return null};Util.isReferrerSocialDomain=function(){var b=this.socialReferrer(),c=["twitter","facebook","google-plus","yahoo","yahoo sports"];var a=jQuery.inArray(b,c);return a>-1};Util.isReferrerCurrentDomain=function(){var a=this.getReferrerDomain(),b=location.href.split("/")[2];return a===b};Util.loadScriptAsync=function(a,d){var c=document.createElement("SCRIPT"),b=document.getElementsByTagName("SCRIPT")[0];c.type="text/javascript";c.async=true;c.src=a;d&&(c.onload=d);b.parentNode.insertBefore(c,b)};Util.Dates={};Util.Dates.lastDateValues={};Util.Dates.updateDate=function(d){var c=jQuery("#"+d+"_freeform").val();if(c==""){jQuery("#"+d+"_english").text("");jQuery("#"+d).val("")}else{if(c!=this.lastDateValues[d]){var b=null;var a=Date.parse(c);if(a){b=a.toString("ddd, MMM d, yyyy");jQuery("#"+d).val(a.toISOString().replace(/"/g,""))}else{b="Enter a valid date."}jQuery("#"+d+"_english").text(b);this.lastDateValues[d]=c}}};Util.characterCountdown=function(d,c){var b=d.attr("maxlength");c.text(b-d.val().length);var a=jQuery("<div class='error' style='display:none'>Some of your text was cut off because it exceeded the limit</div>");d.before(a);d.removeAttr("maxlength");d.keyup(function(){var e=d.val().length;if(e>b){d.val(d.val().substr(0,b));a.show();e=d.val().length}else{a.hide()}c.text(b-e)})};Util.addQueryParam=function(b,d,a){var c=new RegExp("([?|&])"+b+"=.*?(&|#|$)","gi");if(a.match(c)){if(d){return a.replace(c,"$1"+b+"="+d+"$2")}else{return a.replace(c,"$2")}}else{if(d){var f=a.indexOf("?")!==-1?"&":"?",e=a.split("#");a=e[0]+f+b+"="+d;if(e[1]){a+="#"+e[1]}return a}else{return a}}};Util.gaTrackEvent=function(b){var c=["_trackEvent"].concat(b.data.params);if(c.length>1){try{_gaq.push(c)}catch(a){}Util.handleGaTrackEvent.call(this,b)}};Util.handleGaTrackEvent=function(e){var d=jQuery._data(jQuery(this)[0],"events");if(d&&d.click.length==1&&d.click[d.click.length-1].handler===Util.gaTrackEvent){var b=jQuery(this);var a=b.attr("href");var c=b.attr("onclick");if(typeof a!=="undefined"&&typeof c==="undefined"&&!/^https:\/\/twitter\.com\/intent/i.test(a)&&e.which===1&&!e.metaKey&&!e.ctrlKey){setTimeout(function(){document.location.href=a},100);return false}}};var _gaq=_gaq||[];Util.uaTrackEvent=function(f){if(typeof ga==="undefined"||typeof ga.create==="undefined"){return}var b=jQuery(this);var a=b.attr("href");var c=b.attr("onclick");var g=b.attr("target");var d=typeof a!=="undefined"&&typeof c==="undefined"&&!/^https:\/\/twitter\.com\/intent/i.test(a)&&f.which===1&&!f.metaKey&&!f.ctrlKey;var h=["send","event"].concat(f.data.params);if(d&&typeof g=="undefined"){h=h.concat([{hitCallback:function(){document.location=a}}])}try{ga.apply(this,h)}catch(e){}if(d&&typeof g=="undefined"){return false}};Util.trackLinkedIn=function(a){_gaq.push(["_trackSocial","LinkedIn","Share",a]);_gaq.push(["_trackEvent","Social","LinkedIn : Share",a])};Util.trackGooglePlus=function(a){if(a.state==="on"){_gaq.push(["_trackEvent","Social","Google : +1",a.href])}else{_gaq.push(["_trackEvent","Social","Google : -1",a.href])}};Util.trackFacebook=function(a){if(typeof a==="undefined"){throw Error("Specify a Facebook App ID")}window.fbAsyncInit=function(){FB.init({appId:a,status:true,cookie:true,xfbml:true});FB.Event.subscribe("edge.create",function(b){_gaq.push(["_trackEvent","Social","Facebook : Like",b]);_gaq.push(["_trackSocial","Facebook","Like",b]);if(b.match(/facebook\.com\/ThisIsTheVerge/i)){_gaq.push(["_trackEvent","Follow Bar","Facebook : Like",b])}});FB.Event.subscribe("edge.remove",function(b){_gaq.push(["_trackEvent","Social","Facebook : Unlike",b]);_gaq.push(["_trackSocial","Facebook","Unlike",b]);if(b.match(/facebook\.com\/ThisIsTheVerge/i)){_gaq.push(["_trackEvent","Follow Bar","Facebook : Unlike",b])}})}};Util.trackTwitter=function(){window.twttr=window.twttr||(t={_e:[],ready:function(a){t._e.push(a)}});twttr.ready(function(a){a.events.bind("tweet",function(b){_gaq.push(["_trackEvent","Social","Twitter : Tweet",location.href]);_gaq.push(["_trackSocial","Twitter","Tweet",location.href])});a.events.bind("follow",function(b){_gaq.push(["_trackEvent","Social","Twitter : Follow","@"+b.data.screen_name]);_gaq.push(["_trackSocial","Twitter","Follow","@"+b.data.screen_name]);if(jQuery(b.target).parent().hasClass("follow-the-verge")){_gaq.push(["_trackEvent","Follow Bar","Twitter : Follow","@"+b.data.screen_name])}});a.events.bind("retweet",function(b){_gaq.push(["_trackEvent","Social","Twitter : Retweet",b.data.source_tweet_id]);_gaq.push(["_trackSocial","Twitter","Retweet",b.data.source_tweet_id])});a.events.bind("favorite",function(b){_gaq.push(["_trackEvent","Social","Twitter : Favorite",b.data.tweet_id]);_gaq.push(["_trackSocial","Twitter","Favorite",b.data.tweet_id])})})};Util.stringToTitleCase=function(a){return a.replace(/\w\S*/g,function(b){return b.charAt(0).toUpperCase()+b.substr(1).toLowerCase()})};var Chorus=Chorus||{};Chorus.Analytics=(function(b){function a(){var c=window[window.GoogleAnalyticsObject];if(typeof c=="function"){c(function(){setTimeout(function(){if(window.history.replaceState){var d=window.location.search.replace(/utm_[^&]+&?/g,"").replace(/&$/,"").replace(/^\?$/,"");window.history.replaceState({},document.title,window.location.pathname+d+window.location.hash)}},50)});return true}}if(!a()){b(a)}return{push:function(c){_gaq.push(c)}}})(jQuery);function OoyalaWrapper(f,b,n){var d={autoplay:false,namespace:"OO",platform:"html5-fallback",player_id:window.ooyala_player_id};var j={callback:function(){},onAdsPlayed:function(){},onCreate:function(){},onPlay:function(){}};var c={send:"send",hitType:"event",eventCategory:"video",eventAction:"video:play:general",eventLabel:b.title||"No title"};var e=jQuery;var l=this;var a=window.ooyala_options||{};var n=e.extend(d,a,n);var i=e.extend(j,n);this.elementId=f;this.destroy=function(){if(typeof this.player!=="undefined"){this.player.destroy()}};function m(){var o=n.ga;if(typeof ga!=="function"||typeof o==="undefined"){return}else{if(o instanceof Array){ga.apply(undefined,o)}else{var o=e.extend(c,o);var p=o.send;delete o.send;ga(p,o)}}}function h(){if(n.setViewedVideos){var o=JSON.parse(localStorage.getItem("viewedVideos"))||[];o.unshift(b);o=o.slice(0,5);localStorage.viewedVideos=JSON.stringify(o)}}function g(p){var o=p.mb;o.subscribe("playing","basePlaying",function(q){o.unsubscribe("playing","basePlaying");Chorus.EventDispatcher.publish("ooyalaVideoPlay",{player:l.player});m();h();i.onPlay(p,false)});o.subscribe("adsPlayed","baseAdsPlayed",function(q){o.unsubscribe("adsPlayed","baseAdsPlayed");i.onAdsPlayed(p)})}function k(){var p="//player.ooyala.com/v3/"+n.player_id+"?";var o=["namespace","platform","version","tweaks"];for(var q=0;q<o.length;q++){var r=o[q];if(typeof n[r]!=="undefined"){p+=[r,"=",n[r],"&"].join("")}}return p}yepnope({test:window[n.namespace],nope:k(),complete:function(){var o=window[n.namespace];o.ready(function(){l.player=o.Player.create(f,b.provider_video_id,n);g(l.player);n.callback(l.player)})}})}function YoutubeWrapper(f,a,n){var d={autoplay:false,controls:1,modestbranding:1,rel:0,showInfo:0};var j={onAdsPlayed:function(){},onCreate:function(){},onPause:function(){},onPlay:function(){},onPlayerReady:function(){},onPreRollEnd:function(){},timedEvents:{}};var b={hitType:"event",eventCategory:"video",eventAction:"video:play:general",eventLabel:a.title||"No title"};var e=jQuery;var l=this;var g=false;var n=e.extend(d,n);var h=e.extend(j,n);n.autoplay=n.autoplay?1:0,this.elementId=f;this.destroy=function(){this.player.destroy()};if(!Chorus.Video.youtubeApiLoaded){Chorus.Video.loadYoutubeApi()}function m(){var o=n.ga;if(typeof ga!=="function"||typeof o==="undefined"){return}else{if(o instanceof Array){ga.apply(undefined,o)}else{var o=e.extend(b,o);ga("send",o)}}}function k(o){if(o.data===YT.PlayerState.PLAYING){h.onPlay(l.player);if(!g){m();Chorus.EventDispatcher.publish("youtubeVideoPlay",{player:l.player});g=true}}else{if(o.data===YT.PlayerState.PAUSED){h.onPause(l.player)}}}function c(o,p){l.player=new YT.Player(o,{videoId:p,playerVars:n,events:{onReady:h.onCreate,onStateChange:k}})}function i(o,p){if(typeof(YT)=="undefined"||typeof(YT.Player)=="undefined"){window.onYouTubeIframeAPIReady=function(){c(o,p)}}else{c(o,p)}}i(f,a.provider_video_id)}var Chorus=Chorus||{};Chorus.VideoContext=(function(f){var e={};var a={};function j(){return e}function h(){return a}function l(q){if(q instanceof Array===false){q=new Array(q)}for(var n=0;n<q.length;n++){var o=q[n];var p=q[n]["id"];e[p]=o}}function k(p,o){var n=m(p,o);l(n);return n.id}function m(o,n){return{id:"ooyala"+Object.keys(e).length,preview_urls:{},provider_video_data:{},provider_video_id:o,provider_video_type:"ooyala",title:n}}function d(n){var q=Object.keys(a);for(var p=0;p<q.length;p++){var r=q[p];var o=a[r];if(o.elementId===n){c(r);break}}}function c(o){var n=a[o];if(typeof n!=="undefined"){n.destroy()}delete a[o]}function g(){var o=Object.keys(a);for(var n=0;n<o.length;n++){c(o[n])}}function i(n){return e[n]}function b(n,q,o){var p=e[q];if(p.provider_video_type==="ooyala"){d(n);a[q]=new OoyalaWrapper(n,p,o)}else{if(p.provider_video_type==="youtube"){d(n);a[q]=new YoutubeWrapper(n,p,o)}}}return{addChorusVideos:l,addCustomVideo:k,addVideo:l,addVideos:l,addVideoFromOoyalaIdWithTitle:k,createPlayer:b,destroyAllPlayers:g,destroyPlayer:c,destroyPlacement:d,getActivePlayers:h,getQueuedVideos:j,getVideo:i}})(jQuery);var Chorus=Chorus||{};Chorus.Video=Chorus.Video||{};Chorus.Video.youtubeApiLoaded=false;Chorus.Video.loadYoutubeApi=function(){jQuery.getScript("//www.youtube.com/iframe_api");Chorus.Video.youtubeApiLoaded=true};Chorus.Video.wrapVideoIframe=function(){var b=jQuery;var a=b(this);var d="";var c=a.attr("src");if(a.parent().hasClass("chorus-video-embed")){return}if(!c||!/youtube|livestream|vimeo|vine|hulu|dailymotion|instagram/.test(c)){return true}if(/hulu\.com/.test(c)){a.attr("width","100%");a.attr("height","100%")}else{if(/instagram\.com/.test(c)){d=" instagram"}else{if(/vine\.co/.test(c)){d=" vine"}}}a.attr("src",c+"?wmode=transparent");a.wrap('<div class="video-wrap'+d+'"></div>')};Chorus.Video.fixLegacyOoyalaPlayer=function(){var a=jQuery;a("div[id*=ooyalaPlayer]").each(function(){a(this).css({height:"100%",width:"100%"})})};Chorus.Video.playInViewport=function(e){var d=500;var b=[];var a=[];e.each(function(){this.pause();b.push(this)});var c=function(){var f;var g=[];while(f=b.pop()){if(Util.inViewport(f)){f.play();a.push(f)}else{g.push(f)}}b=g;g=[];while(f=a.pop()){if(!Util.inViewport(f)){f.pause();b.push(f)}else{g.push(f)}}a=g;setTimeout(c,d)};c()};Chorus.Video.autoplay=false;Chorus.Video.checkForAutoplay=function(){if(window.history.length<=1){return false}if(Chorus.Video.autoplay){return true}return(Util.isReferrerCurrentDomain()&&jQuery("body").hasClass("video-entry")&&Util.UserAgentProfiler.isDesktop())};Chorus.Video.init=function(b){b=b||{};var c=jQuery;var a=b.callback;b=c.extend({checkForExistingPlayer:false},b);Chorus.Video.fixLegacyOoyalaPlayer();c(".chorus-video-embed").each(function(d,f){if(b.checkForExistingPlayer&&c(f).hasClass("chorus-video-player-loaded")){return}var e=c.extend({},b,{autoplay:(d===0)?Chorus.Video.checkForAutoplay():false,setViewedVideos:["sbn","verge"].indexOf(Chorus.Context.network_slug)>-1,ga:{send:["sbn"].indexOf(Chorus.Context.network_slug)>-1?"t1.send":"send"},callback:function(g){Chorus.VideoContext.ooyalaPlayer=g;c(f).addClass("chorus-video-player-loaded");Chorus.EventDispatcher.publish("ooyalaPlayerLoaded",{ooyalaPlayer:g});if(typeof a=="function"){a.call(f,g)}}});Chorus.VideoContext.createPlayer(f.id,c(f).data("chorus-video-id"),e)})};if(window.jQuery){jQuery(function(){Chorus.Video.init()})};